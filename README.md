# img2mesh - PNG转3D网格工具

一个基于Web的交互式工具，可以将PNG图片转换为3D网格模型，支持实时预览和导出OBJ格式文件。

## 功能特点

### 核心功能
- **PNG转3D网格**: 将PNG图片的轮廓转换为3D网格模型
- **智能遮罩**: 支持透明度阈值和颜色选择两种遮罩模式
- **实时预览**: 实时显示遮罩预览和3D网格效果
- **OBJ导出**: 导出标准OBJ格式3D模型文件，包含UV纹理坐标

### 高级功能
- **吸管工具**: 点击图片选择要保留的颜色
- **网格优化**: 可调节精度参数，控制网格细节程度
- **遮罩扩展**: 支持扩展遮罩范围，增强边缘效果
- **多种显示模式**: 支持轮廓、线框、顶点等多种显示模式

### 交互功能
- **画布拖拽**: 支持拖拽移动图片位置
- **缩放功能**: 支持鼠标滚轮缩放，锚点为鼠标位置
- **重置视图**: 一键重置视图到初始状态
- **进度显示**: 网格生成过程中显示实时进度

## 使用方法

1. **上传图片**: 点击"选择图片"按钮，选择要转换的PNG图片
2. **调整参数**: 
   - 透明度阈值/颜色容差: 控制遮罩敏感度
   - 扩展半径: 扩展遮罩范围
   - 精度: 控制网格细节程度
3. **预览遮罩**: 实时查看生成的遮罩效果
4. **生成网格**: 点击"生成网格"按钮，等待处理完成
5. **调整显示**: 可切换线框、顶点等显示模式
6. **导出模型**: 点击"导出OBJ"按钮，下载3D模型文件

## 技术实现

### 核心算法
- **Earcut三角剖分**: 使用高效的Earcut算法将轮廓转换为三角形网格
- **RDP点简化**: 使用Ramer-Douglas-Peucker算法简化轮廓点，减少网格复杂度
- **轮廓检测**: 基于二值图像的轮廓检测算法
- **图像处理**: 支持透明度阈值和颜色相似度两种图像分割方式

### 前端技术
- **HTML5 Canvas**: 用于图像处理和实时渲染
- **JavaScript ES6**: 使用现代JavaScript语法和API
- **响应式设计**: 适配不同屏幕尺寸
- **性能优化**: 使用时间片技术处理大量数据，保持界面响应

### 文件结构
```
img2mesh/
├── img2mesh.html    # 主程序文件，包含所有HTML、CSS和JavaScript代码
└── README.md        # 项目说明文档
```

## 界面说明

### 侧边栏控制面板
- **图片上传**: 选择要处理的PNG图片
- **遮罩定义**: 
  - 透明度阈值/颜色容差滑块
  - 扩展半径滑块
  - 吸管工具开关
  - 关键颜色显示和清除按钮
- **网格优化**: 精度滑块，控制网格细节
- **显示选项**: 
  - 遮罩预览开关
  - 线框显示开关
  - 顶点显示开关
- **操作按钮**: 
  - 生成网格/重新生成
  - 重置视图
  - 导出OBJ

### 主视图区域
- **3D预览**: 显示生成的3D网格
- **交互控制**: 支持拖拽和缩放
- **状态显示**: 显示当前模式和操作状态

### 状态条
- **模式标识**: 显示当前是"预览遮罩"还是"网格视图"模式
- **状态信息**: 显示操作状态和网格统计信息
- **进度条**: 显示网格生成进度

## 配置参数

### 遮罩参数
- **透明度阈值**: 0-100，控制透明度判断阈值
- **颜色容差**: 0-100，控制颜色相似度判断阈值
- **扩展半径**: 0-50像素，控制遮罩扩展范围

### 网格参数
- **精度**: 0.5-50像素，控制网格细节程度，值越小网格越精细

### 显示参数
- **遮罩预览**: 开启/关闭遮罩预览
- **线框显示**: 开启/关闭网格线框显示
- **顶点显示**: 开启/关闭网格顶点显示

## 性能特点

- **自适应精度**: 根据图片尺寸自动调整默认精度参数
- **时间片处理**: 使用16ms时间片处理大量数据，保持界面响应
- **实时预览**: 参数调整时实时更新预览效果
- **内存优化**: 使用TypedArray提高数据处理效率

## 应用场景

- **游戏开发**: 将2D素材转换为3D模型
- **3D打印**: 将平面图像转换为3D打印模型
- **动画制作**: 从2D图像创建3D动画素材
- **原型设计**: 快速创建3D概念模型

## 系统要求

- **浏览器**: 支持HTML5 Canvas的现代浏览器
- **操作系统**: 跨平台支持
- **内存**: 建议至少4GB内存，处理大图片时需要更多内存

## 许可证

本项目采用MIT许可证，详见LICENSE文件。

## 贡献

欢迎提交Issue和Pull Request来改进这个项目。

## 更新日志

### v1.0.0
- 初始版本发布
- 支持PNG转3D网格基本功能
- 支持OBJ格式导出
- 实现实时预览和交互功能